"use strict";(self.webpackChunksolus_help_center=self.webpackChunksolus_help_center||[]).push([["995"],{1249:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>l,toc:()=>o,default:()=>a,metadata:()=>i,assets:()=>t,contentTitle:()=>c});var i=JSON.parse('{"id":"packaging/package.yml","title":"Package YAML","description":"Each package is generated from a single build file named package.yml. This file is sometimes also called a \\"recipe\\" since it provides steps for building a package. It provides all of the required metadata for the package manager, plus the packaging steps involved to produce a package. This file follows the YAML specification.","source":"@site/docs/packaging/package.yml.md","sourceDirName":"packaging","slug":"/packaging/package.yml","permalink":"/docs/packaging/package.yml","draft":false,"unlisted":false,"editUrl":"https://github.com/getsolus/help-center-docs/tree/master/docs/packaging/package.yml.md","tags":[],"version":"current","lastUpdatedAt":1762631307000,"frontMatter":{"title":"Package YAML","summary":"Learning the package.yml packaging format"},"sidebar":"packagingSidebar","previous":{"title":"Monitoring YAML","permalink":"/docs/packaging/monitoring.yaml"},"next":{"title":"Packaging Practices","permalink":"/docs/packaging/packaging-practices"}}'),r=n(74848),d=n(84429);let l={title:"Package YAML",summary:"Learning the package.yml packaging format"},c="package.yml",t={},o=[{value:"Format",id:"format",level:2},{value:"Keys",id:"keys",level:2},{value:"Mandatory keys",id:"mandatory-keys",level:3},{value:"&quot;source&quot; key",id:"source-key",level:4},{value:"Optional, supported keys",id:"optional-supported-keys",level:3},{value:"Packaging step keys, optional",id:"packaging-step-keys-optional",level:3},{value:"Optimize values",id:"optimize-values",level:2},{value:"Macros",id:"macros",level:2},{value:"Usage",id:"usage",level:3},{value:"Actionable macros",id:"actionable-macros",level:3},{value:"Haskell actionable macros",id:"haskell-actionable-macros",level:3},{value:"Ninja actionable macros",id:"ninja-actionable-macros",level:3},{value:"Perl actionable macros",id:"perl-actionable-macros",level:3},{value:"Python actionable macros",id:"python-actionable-macros",level:3},{value:"Ruby actionable macros",id:"ruby-actionable-macros",level:3},{value:"Rust (cargo) actionable macros",id:"rust-cargo-actionable-macros",level:3},{value:"Qt actionable macros",id:"qt-actionable-macros",level:3},{value:"Waf actionable macros",id:"waf-actionable-macros",level:3},{value:"BOLT actionable macros",id:"bolt-actionable-macros",level:3},{value:"Variable macros",id:"variable-macros",level:3},{value:"Variables",id:"variables",level:2},{value:"Types",id:"types",level:2},{value:"string",id:"string",level:3},{value:"string(s)",id:"strings",level:3},{value:"integer",id:"integer",level:3},{value:"list",id:"list",level:3},{value:"dict",id:"dict",level:3},{value:"dict(s)",id:"dicts",level:3},{value:"Packaging practices",id:"packaging-practices",level:2}];function h(e){let s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"packageyml",children:(0,r.jsx)(s.code,{children:"package.yml"})})}),"\n",(0,r.jsxs)(s.p,{children:["Each package is generated from a single build file named ",(0,r.jsx)(s.code,{children:"package.yml"}),'. This file is sometimes also called a "recipe" since it provides steps for building a package. It provides all of the required metadata for the package manager, plus the packaging steps involved to produce a package. This file follows the YAML specification.']}),"\n",(0,r.jsx)(s.h2,{id:"format",children:"Format"}),"\n",(0,r.jsxs)(s.p,{children:["All ",(0,r.jsx)(s.code,{children:"package.yml"})," files ",(0,r.jsx)(s.strong,{children:"must"})," be valid YAML."]}),"\n",(0,r.jsxs)(s.p,{children:["The file is organised into a key\u2192value hierarchy. The ",(0,r.jsx)(s.code,{children:"ypkg"})," tool parses a ",(0,r.jsx)(s.code,{children:"package.yml"})," file to build the corresponding package in a declarative manner. As such, most of the keys are simple strings, lists or nested key\u2192value pairs. A special case consists in the packaging steps, which are scripts."]}),"\n",(0,r.jsx)(s.p,{children:"An example file follows:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"name       : nano\nversion    : 2.9.5\nrelease    : 96\nsource     :\n    - https://www.nano-editor.org/dist/v2.9/nano-2.9.5.tar.xz: 7b8d181cb57f42fa86a380bb9ad46abab859b60383607f731b65a9077f4b4e19\nhomepage   : https://www.nano-editor.org\nlicense    : GPL-3.0-or-later\nsummary    : Small, friendly text editor inspired by Pico\ncomponent  : system.devel\ndescription: |\n    GNU nano is an easy-to-use text editor originally designed as a replacement for Pico, the ncurses-based editor from the non-free mailer package Pine (itself now available under the Apache License as Alpine).\nsetup      : |\n    %patch -p1 -i $pkgfiles/0001-Use-a-stateless-configuration.patch\n    %reconfigure --enable-utf8 --docdir=/usr/share/doc/nano\nbuild      : |\n    %make\ninstall    : |\n    %make_install\n    install -D -m 00644 $pkgfiles/nanorc $installdir/usr/share/defaults/nano/nanorc\n    install -D -m 00644 $pkgfiles/git.nanorc $installdir/usr/share/nano/git.nanorc\n    # https://github.com/scopatz/nanorc\n    for rcFile in $pkgfiles/nanorc-extras/*.nanorc; do\n        install -m 00644 $rcFile $installdir/usr/share/nano\n    done\n"})}),"\n",(0,r.jsx)(s.h2,{id:"keys",children:"Keys"}),"\n",(0,r.jsxs)(s.p,{children:["Not all fields in ",(0,r.jsx)(s.code,{children:"package.yml"})," are mandatory, but a small selection are. Below is the complete list of the available fields."]}),"\n",(0,r.jsx)(s.h3,{id:"mandatory-keys",children:"Mandatory keys"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Key Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"name"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"The name of the package. This is also used as the base of all sub-package names. Unless unavoidable, this should match the upstream name."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"version"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"The version of the currently packaged software. This is taken from the tarball in most cases."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"release"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"integer"})}),(0,r.jsxs)(s.td,{children:["Specifies the current release number. Updates in the package number are based on this ",(0,r.jsx)(s.code,{children:"release"})," number, ",(0,r.jsx)(s.em,{children:"not"})," the ",(0,r.jsx)(s.code,{children:"version"})," number. As such, to release an update to users, this number must be incremented by one."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"source"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"dict(s)"})}),(0,r.jsxs)(s.td,{children:["See ",(0,r.jsx)(s.a,{href:"/docs/packaging/package.yml#source-key",children:"source key"})," below."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"homepage"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"Provides a link to the package's homepage, used in the Software Center."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"license"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string(s)"})}),(0,r.jsxs)(s.td,{children:["Valid upstream license(s). Try to ensure these use ",(0,r.jsx)(s.a,{href:"https://spdx.org/licenses/",children:"SPDX identifiers"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"summary"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"Brief package summary, or display name."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"component"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsxs)(s.td,{children:["Component / group of packages this package belongs to. Check available components via ",(0,r.jsx)(s.code,{children:"eopkg lc"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"description"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"More extensive description of the software, usually taken from the vendor website."})]})]})]}),"\n",(0,r.jsx)(s.h4,{id:"source-key",children:'"source" key'}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Tarball source","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:['Upstream source URL to the source code archive (often called the "tarball"), followed by the ',(0,r.jsx)(s.code,{children:"sha256sum"})," for the tarball, as a value."]}),"\n",(0,r.jsxs)(s.li,{children:["Example: ",(0,r.jsx)(s.code,{children:"https://www.nano-editor.org/dist/v7/nano-7.2.tar.xz : 86f3442768bd2873cec693f83cdf80b4b444ad3cc14760b74361474fc87a4526"})]}),"\n",(0,r.jsx)(s.li,{children:"Tarball sources are preferred over git sources, whenever possible, because git tags can be changed to point to different commits."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Git source","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Git repository URL prefixed with ",(0,r.jsx)(s.code,{children:"git|"}),", followed by the git tag or commit hash, as a value."]}),"\n",(0,r.jsxs)(s.li,{children:["Example: ",(0,r.jsx)(s.code,{children:"git|https://github.com/getsolus/solus-sc.git : 6e786b3e86982272717ca4bed4f783fc43a678f3"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Multiple sources","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If multiple sources are listed, only the first source will be copied from the ",(0,r.jsx)(s.code,{children:"$sources"})," directory to the ",(0,r.jsx)(s.code,{children:"$workdir"})," directory."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Renaming sources","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"If the file resulting from the source download needs to be renamed (often to avoid a name that would conflict with another source), add the preferred name to the URL as a URI fragment."}),"\n",(0,r.jsxs)(s.li,{children:["Example: ",(0,r.jsx)(s.code,{children:"https://github.com/docker/cli/archive/refs/tags/v25.0.3.tar.gz#docker-cli.tar.gz : 04ad0cea992a65db20cb1b0dbf6d1ce32c705ce879de51b22095fe8d28030815"})]}),"\n",(0,r.jsxs)(s.li,{children:["This renames the downloaded file from ",(0,r.jsx)(s.code,{children:"v25.0.3.tar.gz"})," to ",(0,r.jsx)(s.code,{children:"docker-cli.tar.gz"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["SourceForge sources","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["A proper SourceForge source looks like this, using ",(0,r.jsx)(s.code,{children:"hplip"})," as an example: ",(0,r.jsx)(s.code,{children:"https://sourceforge.net/projects/hplip/files/hplip/3.24.4/hplip-3.24.4.tar.gz"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["This URL begins with ",(0,r.jsx)(s.code,{children:"https://sourceforge.net/"}),", not ",(0,r.jsx)(s.code,{children:"https://downloads.sourceforge.net/"}),", or some other mirror."]}),"\n",(0,r.jsxs)(s.li,{children:["This URL has a path beginning with ",(0,r.jsx)(s.code,{children:"/projects/$project_name/"})]}),"\n",(0,r.jsxs)(s.li,{children:["This URL does ",(0,r.jsx)(s.em,{children:"not"})," have a trailing ",(0,r.jsx)(s.code,{children:"/download"}),", you may have to remove this by hand."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.li,{children:'The correct SourceForge tarball URLs are found under the "Files" tab, then often within a directory, when starting from a project homepage on SourceForge.'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"optional-supported-keys",children:"Optional, supported keys"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Key Name"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"clang"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"true"})," if this package benefits from being built with Clang."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"extract"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"false"})," to disable automatic source extraction."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"autodep"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"false"})," to disable automatic binary dependency resolution at build time."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"emul32"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"true"})," to enable an ",(0,r.jsx)(s.code,{children:"-m32"})," build (32-bit libs)."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"libsplit"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"false"})," to disable splitting of libraries into ",(0,r.jsx)(s.code,{children:"devel"})," sub-packages."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"conflicts"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string(s)"})}),(0,r.jsx)(s.td,{children:"Specify packages that cannot be installed together with this one."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"optimize"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"list"})}),(0,r.jsxs)(s.td,{children:["Specify preset keys to modify compiler and linker flags during build. You can learn more ",(0,r.jsx)(s.a,{href:"/docs/packaging/package.yml#optimize-values",children:"here"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"builddeps"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"list"})}),(0,r.jsxs)(s.td,{children:["Specify build dependencies for the package. You can learn more ",(0,r.jsx)(s.a,{href:"/docs/packaging/packaging-practices#build-dependencies",children:"here"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"rundeps"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"dict(s)"})}),(0,r.jsxs)(s.td,{children:["Specify further runtime dependencies for the packages. You can learn more ",(0,r.jsx)(s.a,{href:"/docs/packaging/packaging-practices#runtime-dependencies",children:"here"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"checkdeps"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"dict(s)"})}),(0,r.jsxs)(s.td,{children:["Specify build dependencies for the package which will ",(0,r.jsx)(s.em,{children:"not"})," be considered when determining build order for automatic builds. These dependencies should only be used during the ",(0,r.jsx)(s.code,{children:"check"})," build phase. You can learn more ",(0,r.jsx)(s.a,{href:"/docs/packaging/packaging-practices#check-dependencies",children:"here"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"replaces"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"dict(s)"})}),(0,r.jsx)(s.td,{children:"Replace one package with another, used when renaming or deprecating packages for clean upgrade paths."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"patterns"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"dict(s)"})}),(0,r.jsxs)(s.td,{children:["Allows fine grained control over file placement within the package or sub-packages. Useful for packages that are development only (i.e. ",(0,r.jsx)(s.code,{children:"/usr/bin"})," files). You can learn more ",(0,r.jsx)(s.a,{href:"/docs/packaging/packaging-practices#patterns",children:"here"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"environment"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"unicode"})}),(0,r.jsx)(s.td,{children:"Specify code that will be exported to all packaging steps of the build (i.e. exporting variables for the entire build)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"networking"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"bool"})}),(0,r.jsxs)(s.td,{children:["Set to ",(0,r.jsx)(s.code,{children:"true"})," to enable networking within solbuild."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"packaging-step-keys-optional",children:"Packaging step keys, optional"}),"\n",(0,r.jsxs)(s.p,{children:["The packaging steps are all considered optional, however the absence of the ",(0,r.jsx)(s.code,{children:"install"})," step will result in no package generated. Each of these keys contains content that will be placed within a script and executed within a controlled environment to perform the package build. For all intents and purposes, they are Bash scripts with a predefined environment."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Step Name"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"setup"})}),(0,r.jsxs)(s.td,{children:["Performed after the source extraction. This is the correct place to perform any ",(0,r.jsx)(s.code,{children:"configure"})," routine, or to ",(0,r.jsx)(s.code,{children:"patch"})," the sources."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"build"})}),(0,r.jsxs)(s.td,{children:["Use this step to run the build portion, for example, ",(0,r.jsx)(s.code,{children:"make"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"install"})}),(0,r.jsxs)(s.td,{children:["This is where you should install the files into the final packaging directory, for example, ",(0,r.jsx)(s.code,{children:"make install"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"check"})}),(0,r.jsxs)(s.td,{children:["This is where tests / checking should occur, for example, ",(0,r.jsx)(s.code,{children:"make check"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"profile"})}),(0,r.jsxs)(s.td,{children:["This is where profiling tests should be specified. ",(0,r.jsx)(s.code,{children:"ypkg"})," will handle setting flags to generate profiling data and using that data for an optimized build."]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"optimize-values",children:"Optimize values"}),"\n",(0,r.jsxs)(s.p,{children:["One or more optimize values can be specified in a list with the ",(0,r.jsx)(s.code,{children:"optimize"})," key in the ",(0,r.jsx)(s.code,{children:"package.yml"})," file. Several values can override or conflict with each other and should be used only where they provide a performance benefit, or fix a bug in the package or build."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Optimize Value"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"speed"})}),(0,r.jsxs)(s.td,{children:["Optimizes the package for performance ",(0,r.jsx)(s.code,{children:"-O3"})," plus other flags."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"size"})}),(0,r.jsxs)(s.td,{children:["Optimizes the package build to minimize size ",(0,r.jsx)(s.code,{children:"-Os"}),". Not supported with clang."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"no-bind-now"})}),(0,r.jsx)(s.td,{children:"Configures the package to disable certain flags, where RELRO is unsupported."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"no-symbolic"})}),(0,r.jsxs)(s.td,{children:["Disables ",(0,r.jsx)(s.code,{children:"-Wl,-Bsymbolic-functions"})," linker flag."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"unroll-loops"})}),(0,r.jsxs)(s.td,{children:["Enables ",(0,r.jsx)(s.code,{children:"-funroll-loops"}),". Use this sparingly, only when it provides proven benefit."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"runpath"})}),(0,r.jsxs)(s.td,{children:["Enables ",(0,r.jsx)(s.code,{children:"-Wl,--enable-new-dtags"})," to make linker use RUNPATH's instead of RPATH's."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"avx256"})}),(0,r.jsxs)(s.td,{children:["Disables ",(0,r.jsx)(s.code,{children:"-mprefer-vector-width=128"})," in avx2 builds."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"thin-lto"})}),(0,r.jsxs)(s.td,{children:["Enables Thin Link Time Optimization ",(0,r.jsx)(s.code,{children:"-flto=thin"})," with a supported linker."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"lto"})}),(0,r.jsxs)(s.td,{children:["Enables Link Time Optimization ",(0,r.jsx)(s.code,{children:"-flto"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"icf-safe"})}),(0,r.jsxs)(s.td,{children:["Enables safe Identical Cold Folding ",(0,r.jsx)(s.code,{children:"--icf=safe"}),". ",(0,r.jsx)(s.code,{children:"function-sections"})," is recommended when not using clang. Uses gold linker when not using clang."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"icf-all"})}),(0,r.jsxs)(s.td,{children:["Enables Identical Cold Folding ",(0,r.jsx)(s.code,{children:"--icf=all"}),". ",(0,r.jsx)(s.code,{children:"function-sections"})," is recommended when not using clang. Uses gold linker when not using clang."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"polly"})}),(0,r.jsx)(s.td,{children:"Enables polyhedral optimizations for the clang toolchain."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"function-sections"})}),(0,r.jsx)(s.td,{children:"Generate a separate ELF section for each function. Recommended with ICF when not using clang."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"no-reorder-blocks-partition"})}),(0,r.jsx)(s.td,{children:"Disables block partition reordering with the gcc toolchain. Provided to facilitate BOLT'ed binaries/libraries."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"emit-relocs"})}),(0,r.jsx)(s.td,{children:"Instructs the linker to emit relocations. Provided to facilitate BOLT'ed binaries/libraries."})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"macros",children:"Macros"}),"\n",(0,r.jsx)(s.p,{children:"To further assist in packaging, a number of macros are available. These are simply shorthand ways to perform a normal build operation. They also ensure that the resulting package is consistent. These macros are only available in our packaging steps, as they are substituted within the script before execution."}),"\n",(0,r.jsx)(s.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(s.p,{children:["Macros are prefixed with ",(0,r.jsx)(s.code,{children:"%"}),", and are substituted before your script is executed. Macros ending with ",(0,r.jsx)(s.code,{children:"%"})," are used to provide directory names or build values to the script."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Run the configure macro with the given arguments\n%configure --disable-static\n"})}),"\n",(0,r.jsx)(s.h3,{id:"actionable-macros",children:"Actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%autogen"})}),(0,r.jsxs)(s.td,{children:["Runs autogen with our ",(0,r.jsx)(s.code,{children:"%CONFOPTS%"})," to create a configure script then proceeds to run ",(0,r.jsx)(s.code,{children:"%configure"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cmake"})}),(0,r.jsx)(s.td,{children:"Configures a CMake project with the distribution specific options, such as prefix and release type."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cmake_ninja"})}),(0,r.jsxs)(s.td,{children:["Configures a CMake project with ninja so it can be used with ",(0,r.jsx)(s.code,{children:"%ninja_build"}),", ",(0,r.jsx)(s.code,{children:"%ninja_install"})," and ",(0,r.jsx)(s.code,{children:"%ninja_check"})," macros."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%configure"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"./configure"})," with our ",(0,r.jsx)(s.code,{children:"%CONFOPTS%"})," variable macro."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%configure_no_runstatedir"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"%configure"})," without the ",(0,r.jsx)(s.code,{children:"--runstatedir"})," option. Use if you encounter ",(0,r.jsx)(s.code,{children:"configure: error: unrecognized option: '--runstatedir=/run'"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%make"})}),(0,r.jsxs)(s.td,{children:["Runs the ",(0,r.jsx)(s.code,{children:"make"})," command with the job count specified in ",(0,r.jsx)(s.code,{children:"eopkg.conf"})," (",(0,r.jsx)(s.a,{href:"/docs/packaging/advanced-config/eopkg-configuration",children:"more info"}),")."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%make_install"})}),(0,r.jsxs)(s.td,{children:["Performs a ",(0,r.jsx)(s.code,{children:"make install"}),", using the ",(0,r.jsx)(s.code,{children:"DESTDIR"})," variant. Should work for the vast majority of packages."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%patch"})}),(0,r.jsx)(s.td,{children:"Sane patch macro to run in batch mode and not contaminate source tree on failure."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%apply_patches"})}),(0,r.jsxs)(s.td,{children:["Applies all patches listed in the ",(0,r.jsx)(s.code,{children:"series"})," file in ",(0,r.jsx)(s.code,{children:"./files"})," folder."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%reconfigure"})}),(0,r.jsxs)(s.td,{children:["Updates build scripts such as ",(0,r.jsx)(s.code,{children:"./configure"})," and proceeds to run ",(0,r.jsx)(s.code,{children:"%configure"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%symlink_check"})}),(0,r.jsx)(s.td,{children:"Checks for broken symlinks in the install directory and aborts the build if any are found. Must run after install macros."})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"haskell-actionable-macros",children:"Haskell actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cabal_configure"})}),(0,r.jsx)(s.td,{children:"Configures a Cabal project that requires online dependencies, like a Cargo-style build"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%haskell_configure"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"runhaskell configure"})," with prefix, libdir, etc. and ensures the necessary package.conf.d is copied to the correct location."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%haskell_build"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"runhaskell build"})," with ",(0,r.jsx)(s.code,{children:"%JOBS%"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%haskell_install"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"runhaskell copy"})," to ",(0,r.jsx)(s.code,{children:"$installdir"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%haskell_register"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"runhaskell register"})," to generate a pkg-config for package and version, then installs the conf file."]})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["Existing Haskell packages may use the old ",(0,r.jsx)(s.code,{children:"cabal_build"}),", ",(0,r.jsx)(s.code,{children:"cabal_install"}),", ",(0,r.jsx)(s.code,{children:"cabal_register"})," macros. Please use the new ",(0,r.jsx)(s.code,{children:"haskell_*"})," macros instead."]}),"\n",(0,r.jsx)(s.h3,{id:"ninja-actionable-macros",children:"Ninja actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%meson_configure"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"meson"})," with our CFLAGS and appropriate flags such as ",(0,r.jsx)(s.code,{children:"libdir"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%ninja_build"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"ninja"})," and passes our ",(0,r.jsx)(s.code,{children:"%JOBS%"})," variable. This macro obsoletes ",(0,r.jsx)(s.em,{children:"%meson_build"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%ninja_install"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"ninja install"})," and passes the appropriate ",(0,r.jsx)(s.code,{children:"DESTDIR"})," and ",(0,r.jsx)(s.code,{children:"%JOBS%"})," variable. This macro obsoletes ",(0,r.jsx)(s.em,{children:"%meson_install"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%ninja_check"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"ninja test"})," and passes our ",(0,r.jsx)(s.code,{children:"%JOBS%"})," variable. This macro obsoletes ",(0,r.jsx)(s.em,{children:"%meson_check"}),"."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"perl-actionable-macros",children:"Perl actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%perl_setup"})}),(0,r.jsxs)(s.td,{children:["Runs Perl setup scripts ",(0,r.jsx)(s.code,{children:"Build.pl"})," or ",(0,r.jsx)(s.code,{children:"Makefile.pl"})," with the appropriate variable flags."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%perl_build"})}),(0,r.jsxs)(s.td,{children:["Runs Perl build scripts or attempts ",(0,r.jsx)(s.code,{children:"%make"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%perl_install"})}),(0,r.jsxs)(s.td,{children:["Runs Perl install scripts or attempts ",(0,r.jsx)(s.code,{children:"%make_install"}),"."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"python-actionable-macros",children:"Python actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python_setup"})}),(0,r.jsx)(s.td,{children:"Runs the build portion of a setup.py using python2."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python_install"})}),(0,r.jsx)(s.td,{children:"Runs the install portion of a setup.py, to the appropriate root, using python2."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python_test"})}),(0,r.jsxs)(s.td,{children:["Without argument, runs the test portion of setup.py. With a ",(0,r.jsx)(s.code,{children:".py"}),' script, execute the script with python2. With something else execute the command "as it is". (',(0,r.jsx)(s.a,{href:"https://github.com/getsolus/ypkg/pull/1",children:"More info"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python_compile"})}),(0,r.jsxs)(s.td,{children:["Compiles ",(0,r.jsx)(s.code,{children:"*.py"})," files using python2. This is only useful where the build doesn't compile them already (indicated by availability of ",(0,r.jsx)(s.code,{children:"*.pyc"})," files)."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python3_setup"})}),(0,r.jsx)(s.td,{children:"Runs the build portion of a setup.py using python3."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python3_install"})}),(0,r.jsx)(s.td,{children:"Runs the install portion of a setup.py, to the appropriate root, using python3."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python3_test"})}),(0,r.jsxs)(s.td,{children:["Without argument, runs the test portion of setup.py. With a ",(0,r.jsx)(s.code,{children:".py"}),' script, execute the script with python3. With something else execute the command "as it is". (',(0,r.jsx)(s.a,{href:"https://github.com/getsolus/ypkg/pull/1",children:"More info"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python3_compile"})}),(0,r.jsxs)(s.td,{children:["Compiles ",(0,r.jsx)(s.code,{children:"*.py"})," files using python3. This is only useful where the build doesn't compile them already (indicated by availability of ",(0,r.jsx)(s.code,{children:"*.pyc"})," files)."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"ruby-actionable-macros",children:"Ruby actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%gem_build"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"gem build"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%gem_install"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"gem install"})," with the appropriate parameters."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"rust-cargo-actionable-macros",children:"Rust (cargo) actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cargo_fetch"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"cargo fetch --locked"})," to get dependencies."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cargo_build"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"cargo build"})," with some additional flags."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cargo_install"})}),(0,r.jsxs)(s.td,{children:["Installs the built binary to ",(0,r.jsx)(s.code,{children:"/usr/bin/PACKAGE-NAME"}),", OR to ",(0,r.jsx)(s.code,{children:"/usr/bin/ARGUMENT"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%cargo_test"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"cargo test"})," with some additional flags."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"qt-actionable-macros",children:"Qt actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%qmake"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"qmake"})," for Qt5 with the appropriate make flags."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%qmake4"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"qmake"})," for Qt4, as well as adding the necessary MOC, RCC, and UIC flags since those Qt4 executables end in -qt4."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%qml_cache"})}),(0,r.jsxs)(s.td,{children:["Compiles ",(0,r.jsx)(s.code,{children:"*.qml"})," files into ",(0,r.jsx)(s.code,{children:"*.qmlc"})," so they are compiled ahead of time."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%qml6_cache"})}),(0,r.jsxs)(s.td,{children:["Same as ",(0,r.jsx)(s.code,{children:"%qml_cache"}),", but for Qt6."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"waf-actionable-macros",children:"Waf actionable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%waf_configure"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"waf configure"})," with prefix."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%waf_build"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"waf"})," and passes our ",(0,r.jsx)(s.code,{children:"%JOBS%"})," variable."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%waf_install"})}),(0,r.jsxs)(s.td,{children:["Runs ",(0,r.jsx)(s.code,{children:"waf install"})," and passes the appropriate ",(0,r.jsx)(s.code,{children:"destdir"})," and ",(0,r.jsx)(s.code,{children:"%JOBS%"})," variable."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"bolt-actionable-macros",children:"BOLT actionable macros"}),"\n",(0,r.jsx)(s.p,{children:"BOLT is a post-link optimizer developed to speed up large applications. You will need to run a workload after instrumenting a binary or library. Think of it as post-link profile guided optimization."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%bolt_instr"})}),(0,r.jsxs)(s.td,{children:["Instrument a binary or library with llvm-bolt. Requires it to be built with ",(0,r.jsx)(s.code,{children:"emit-relocs"}),", as well as ",(0,r.jsx)(s.code,{children:"no-reorder-blocks-partition"})," if not using clang."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%bolt_merge"})}),(0,r.jsx)(s.td,{children:"Merge fdata profiles into a single file after running a workload with a BOLT instrumented binary."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%bolt_opt"})}),(0,r.jsxs)(s.td,{children:["Optimize a binary using BOLT after running ",(0,r.jsx)(s.code,{children:"%bolt_merge"}),"."]})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"variable-macros",children:"Variable macros"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Macro"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%ARCH%"})}),(0,r.jsx)(s.td,{children:"Indicates the current build architecture."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%CC%"})}),(0,r.jsx)(s.td,{children:"C compiler."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%CFLAGS%"})}),(0,r.jsxs)(s.td,{children:["cflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%CONFOPTS%"})}),(0,r.jsxs)(s.td,{children:["Flags / options for configuration, such as ",(0,r.jsx)(s.code,{children:"--prefix=%PREFIX%"}),". ",(0,r.jsx)(s.a,{href:"https://github.com/getsolus/ypkg/blob/v33/ypkg2/rc.yml#L446-L458",children:"Full List."})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%CXX%"})}),(0,r.jsx)(s.td,{children:"C++ compiler."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%CXXFLAGS%"})}),(0,r.jsxs)(s.td,{children:["cxxflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%JOBS%"})}),(0,r.jsxs)(s.td,{children:["jobs, as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%LDFLAGS%"})}),(0,r.jsxs)(s.td,{children:["ldflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%LIBSUFFIX%"})}),(0,r.jsx)(s.td,{children:"Library suffix (either 32 for 32-bit or 64 for 64-bit)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%PREFIX%"})}),(0,r.jsxs)(s.td,{children:["Hard-coded prefix ",(0,r.jsx)(s.code,{children:"/usr"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%YJOBS%"})}),(0,r.jsxs)(s.td,{children:["Job count without ",(0,r.jsx)(s.code,{children:"-j"})," as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%installroot%"})}),(0,r.jsx)(s.td,{children:"Hard-coded install directory."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%libdir%"})}),(0,r.jsxs)(s.td,{children:["The distribution\u2019s default library directory, i.e. ",(0,r.jsx)(s.code,{children:"/usr/lib64"})," (Alters for ",(0,r.jsx)(s.code,{children:"emul32"}),")."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%version%"})}),(0,r.jsxs)(s.td,{children:["Version of the package, as specified in the ",(0,r.jsx)(s.code,{children:"version"})," key."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%workdir%"})}),(0,r.jsx)(s.td,{children:"Hard-coded work directory (source tree)."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%kernel_version_lts%"})}),(0,r.jsxs)(s.td,{children:["Version of the ",(0,r.jsx)(s.code,{children:"linux-lts"})," kernel."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%kernel_version_current%"})}),(0,r.jsxs)(s.td,{children:["Version of the ",(0,r.jsx)(s.code,{children:"linux-current"})," kernel."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python2_version%"})}),(0,r.jsxs)(s.td,{children:["Version of the ",(0,r.jsx)(s.code,{children:"python"})," (Python 2) distribution."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"%python3_version%"})}),(0,r.jsxs)(s.td,{children:["Version of the ",(0,r.jsx)(s.code,{children:"python3"})," distribution."]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"variables",children:"Variables"}),"\n",(0,r.jsx)(s.p,{children:"A set of variables are exported in our build stages. These are used to provide context and structure to the scripts."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Variable"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$CFLAGS"})}),(0,r.jsxs)(s.td,{children:["cflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$CXXFLAGS"})}),(0,r.jsxs)(s.td,{children:["cxxflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$LDFLAGS"})}),(0,r.jsxs)(s.td,{children:["ldflags as set in ",(0,r.jsx)(s.code,{children:"eopkg.conf"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$CC"})}),(0,r.jsx)(s.td,{children:"C compiler."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$CXX"})}),(0,r.jsx)(s.td,{children:"C++ compiler."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$EMUL32BUILD"})}),(0,r.jsxs)(s.td,{children:["Set only when compiling in ",(0,r.jsx)(s.code,{children:"emul32"})," mode."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$AVX2BUILD"})}),(0,r.jsxs)(s.td,{children:["Set only when compiling in ",(0,r.jsx)(s.code,{children:"avx2"})," mode."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$PGO_GEN_BUILD"})}),(0,r.jsx)(s.td,{children:"Set during the instrumentation phase of a PGO build."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$PGO_USE_BUILD"})}),(0,r.jsx)(s.td,{children:"Set during the use phase of a PGO build."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$installdir"})}),(0,r.jsx)(s.td,{children:"The install directory, i.e. where files are installed to for packaging."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$pkgfiles"})}),(0,r.jsxs)(s.td,{children:["Refers to the ",(0,r.jsx)(s.code,{children:"./files"})," directory relative to the ",(0,r.jsx)(s.code,{children:"package.yml"})," file."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$sources"})}),(0,r.jsxs)(s.td,{children:["Refers to the directory where your source files are stored, for example, ",(0,r.jsx)(s.code,{children:"$sources/nano.tar.gz"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$workdir"})}),(0,r.jsx)(s.td,{children:"The work, or source, directory of the package build."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"$version"})}),(0,r.jsxs)(s.td,{children:["The version number of the package build as specified in the ",(0,r.jsx)(s.code,{children:"version"})," field."]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"types",children:"Types"}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"package.yml"})," file uses native YAML types, however it follows syntactic conventions and may accept multiple value types for a given key."]}),"\n",(0,r.jsx)(s.h3,{id:"string",children:"string"}),"\n",(0,r.jsx)(s.p,{children:"This is simply text, which does not need to be quoted."}),"\n",(0,r.jsx)(s.h3,{id:"strings",children:"string(s)"}),"\n",(0,r.jsxs)(s.p,{children:["Indicates that it is possible to use a ",(0,r.jsx)(s.code,{children:"list"})," of strings, or one single ",(0,r.jsx)(s.code,{children:"string"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"integer",children:"integer"}),"\n",(0,r.jsxs)(s.p,{children:["Whole, positive number, used in the ",(0,r.jsx)(s.code,{children:"release"})," field."]}),"\n",(0,r.jsx)(s.h3,{id:"list",children:"list"}),"\n",(0,r.jsx)(s.p,{children:"A YAML list (or array) can be expressed in multiple ways. A short array-notation would look like this:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"[one, two, three]"})}),"\n",(0,r.jsx)(s.p,{children:"They can also be expressed like this:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"- First Value\n- Second Value\n- Third Value\n"})}),"\n",(0,r.jsx)(s.h3,{id:"dict",children:"dict"}),"\n",(0,r.jsxs)(s.p,{children:["Known as an associative array, this is key to value mapping. These are separated by a colon (",(0,r.jsx)(s.code,{children:":"}),"), the token on the left is taken to be a key, and the token on the right is the value."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"SomeKey: Some Value"})}),"\n",(0,r.jsxs)(s.p,{children:["Note that each ",(0,r.jsx)(s.code,{children:"ypkg key"})," in the YAML file is actually a dict."]}),"\n",(0,r.jsx)(s.h3,{id:"dicts",children:"dict(s)"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"dict(s)"})," consists of a list of ",(0,r.jsx)(s.code,{children:"dict"}),"s and some assumptions. We primarily make use of this to express advanced information within the package. These permit you to provide no key, and a value only.\nIn this instance, the key is implicitly assumed to be the package name (for example, ",(0,r.jsx)(s.code,{children:"nano"}),"):"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"- some value"})}),"\n",(0,r.jsx)(s.p,{children:"An explicit key, usually a sub-package name:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"- somekey: somevalue"})}),"\n",(0,r.jsx)(s.p,{children:"A mix of both:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"- somevalue\n- somekey: another value\n"})}),"\n",(0,r.jsx)(s.p,{children:"The values may also be expressed in list form, still using the same default key logic:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"- [one, two, three]\n- somekey: [one, two, three]\n- key:\n    - value one\n    - value two\n    - value three\n"})}),"\n",(0,r.jsx)(s.h2,{id:"packaging-practices",children:"Packaging practices"}),"\n",(0,r.jsxs)(s.p,{children:["The concepts in this document merely expose the syntax of a ",(0,r.jsx)(s.code,{children:"package.yml"})," file. Solus adheres to strict packaging practices and conventions which packagers must follow. They are explained in the ",(0,r.jsx)(s.a,{href:"/docs/packaging/packaging-practices",children:"Packaging Practices"})," article."]})]})}function a(e={}){let{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},84429:function(e,s,n){n.d(s,{R:()=>l,x:()=>c});var i=n(96540);let r={},d=i.createContext(r);function l(e){let s=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(d.Provider,{value:s},e.children)}}}]);