"use strict";(self.webpackChunksolus_help_center=self.webpackChunksolus_help_center||[]).push([[5139],{4137:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),d=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=d(e.components);return o.createElement(s.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(t),m=r,h=u["".concat(s,".").concat(m)]||u[m]||p[m]||i;return t?o.createElement(h,a(a({ref:n},c),{},{components:t})):o.createElement(h,a({ref:n},c))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:r,a[1]=l;for(var d=2;d<i;d++)a[d]=t[d];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4969:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var o=t(7462),r=(t(7294),t(4137));const i={title:"Android",summary:"A quick guide to getting set up for Android development on Solus",date:new Date("2023-05-20T00:00:00.000Z")},a="Building Android\u2122 on Solus",l={unversionedId:"user/software/development/android",id:"user/software/development/android",title:"Android",description:"This article covers building the Android Open Source Project (AOSP) on Solus, the instructions can also be tweaked to also install forks of Android such as LineageOS.",source:"@site/docs/user/software/development/android.md",sourceDirName:"user/software/development",slug:"/user/software/development/android",permalink:"/help-center-docs/docs/user/software/development/android",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/user/software/development/android.md",tags:[],version:"current",frontMatter:{title:"Android",summary:"A quick guide to getting set up for Android development on Solus",date:"2023-05-20T00:00:00.000Z"},sidebar:"userSidebar",previous:{title:"Development",permalink:"/help-center-docs/docs/user/software/development/"},next:{title:"Java",permalink:"/help-center-docs/docs/user/software/development/java"}},s={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installing Build Dependencies",id:"installing-build-dependencies",level:3},{value:"Installing the <code>repo</code> Tool",id:"installing-the-repo-tool",level:3},{value:"Downloading the Source Code",id:"downloading-the-source-code",level:2},{value:"Building Android",id:"building-android",level:2},{value:"Tips &amp; Tricks",id:"tips--tricks",level:2},{value:"Using ccache to Speed Up Subsequent Builds",id:"using-ccache-to-speed-up-subsequent-builds",level:3},{value:"More Information",id:"more-information",level:2}],c={toc:d},u="wrapper";function p(e){let{components:n,...t}=e;return(0,r.kt)(u,(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"building-android-on-solus"},"Building Android\u2122 on Solus"),(0,r.kt)("p",null,"This article covers building the ",(0,r.kt)("a",{parentName:"p",href:"https://www.android.com/"},"Android Open Source Project")," (AOSP) on Solus, the instructions can also be tweaked to also install forks of Android such as ",(0,r.kt)("a",{parentName:"p",href:"https://lineageos.org/"},"LineageOS"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Note that Solus is not an officially supported Linux distribution for building Android.")),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"Before we can start we need to setup our build environment ready for building Android. You'll need a minimum of ",(0,r.kt)("inlineCode",{parentName:"p"},"100GB")," of free space to download and compile Android."),(0,r.kt)("h3",{id:"installing-build-dependencies"},"Installing Build Dependencies"),(0,r.kt)("p",null,"Android 7 (Nougat) and Android 8 (Oreo) require OpenJDK 8. Android 5 (Lollipop) and Android 6 (Marshmallow) require OpenJDK 7 which is not currently in the repository."),(0,r.kt)("p",null,"To install OpenJDK 8 run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo eopkg it openjdk-8-devel  \n")),(0,r.kt)("p",null,"Next we need to install packages from the ",(0,r.kt)("inlineCode",{parentName:"p"},"system.devel")," component, these provide common build tools for general software development."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo eopkg it -c system.devel \n")),(0,r.kt)("p",null,"Now we'll need to install the rest of the required build dependencies."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo eopkg it curl-devel git gnupg gperf libgcc-32bit libxslt-devel lzop ncurses-32bit-devel ncurses-devel readline-32bit-devel rsync schedtool sdl1-devel squashfs-tools unzip wxwidgets-devel zip zlib-32bit-devel\n")),(0,r.kt)("h3",{id:"installing-the-repo-tool"},"Installing the ",(0,r.kt)("inlineCode",{parentName:"h3"},"repo")," Tool"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"repo")," is a tool from Google to manage multiple git repositories. We'll need to install it to download the Android source code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir ~/bin \ncurl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo \nchmod a+x ~/bin/repo \n")),(0,r.kt)("p",null,"We now need to export ",(0,r.kt)("inlineCode",{parentName:"p"},"~/bin")," to our PATH so we can run ",(0,r.kt)("inlineCode",{parentName:"p"},"repo")," from any directory. Paste the following into your ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.bashrc")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'if [ -d "$HOME/bin" ] ; then\n    PATH="$HOME/bin:$PATH"\nfi\n')),(0,r.kt)("p",null,"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"source ~/.bashrc")," for the changes to apply."),(0,r.kt)("p",null,"Now our build environment is prepared, we can download the source code."),(0,r.kt)("h2",{id:"downloading-the-source-code"},"Downloading the Source Code"),(0,r.kt)("p",null,"First we need to create a directory where we want to download Android."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir ~/android && cd ~/android\n")),(0,r.kt)("p",null,"Next we'll need to initialize the repository with what version of Android you want to build. You can find a list of versions you can checkout ",(0,r.kt)("a",{parentName:"p",href:"https://source.android.com/source/build-numbers#source-code-tags-and-builds"},"here"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"repo init -u https://android.googlesource.com/platform/manifest -b android-8.0.0_r34 \n")),(0,r.kt)("p",null,"Now we can finally download the source code, this will take a long time and depends on the speed of your internet connection. The ",(0,r.kt)("inlineCode",{parentName:"p"},"-j")," option downloads as many repos simultaneously as you have processor cores, and, the ",(0,r.kt)("inlineCode",{parentName:"p"},"-c")," option only downloads the current branch."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"repo sync -j `nproc` -c\n")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"If you have a slow or unreliable internet connection using ",(0,r.kt)("inlineCode",{parentName:"em"},"j 1")," may be more reliable.")),(0,r.kt)("h2",{id:"building-android"},"Building Android"),(0,r.kt)("p",null,"Once the source has finished downloading we can build Android. The following commands will not build android for any specific device. For building Android specifically for your device you'll need to find additional instructions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"source build/envsetup.sh\nlunch full-eng\nmake -j`nproc`\n")),(0,r.kt)("h2",{id:"tips--tricks"},"Tips & Tricks"),(0,r.kt)("p",null,"There are a number of quality of life improvements you can do to improve your experience of building Android."),(0,r.kt)("h3",{id:"using-ccache-to-speed-up-subsequent-builds"},"Using ccache to Speed Up Subsequent Builds"),(0,r.kt)("p",null,"ccache will cache compiler files after the initial compile to speed up subsequent builds, for building any large project more than once it's a must enable."),(0,r.kt)("p",null,"In your ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.bashrc")," file add the following to specify to use ccache."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"export USE_CCACHE=1\n")),(0,r.kt)("p",null,"You'll also need to specific the max amount of disk space you want ccache to use, where ",(0,r.kt)("inlineCode",{parentName:"p"},"10G")," corresponds to 10GB."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"prebuilts/misc/linux-x86/ccache/ccache -M 10G\n")),(0,r.kt)("p",null,"Additionally you can specify which directory you want the ccache to reside, this can be helpful if you have an additional disk drive. Normally ccache resides at ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.ccache"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"export CCACHE_DIR=/<path_of_your_choice>/.ccache \n")),(0,r.kt)("p",null,"If you're struggling for disk space you can turn on ccache compression to increase the number of files it can cache for a very minor performance penalty. Paste the following into your ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.bashrc")," file to enable."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"export CCACHE_COMPRESS=1\n")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"After making changes to your ",(0,r.kt)("inlineCode",{parentName:"em"},"~/.bashrc")," file, remember to run ",(0,r.kt)("inlineCode",{parentName:"em"},"source ~/.bashrc")," for changes to take effect.")),(0,r.kt)("h2",{id:"more-information"},"More Information"),(0,r.kt)("p",null,"Google has provided build instructions for building AOSP on Ubuntu and MacOS, you may find additional useful information there, not stated here."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://source.android.com/source/requirements"},"https://source.android.com/source/requirements")),(0,r.kt)("p",null,"If your device is supported by LineageOS you can choose your device and follow the device specific build instructions at the LineageOS Wiki."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://wiki.lineageos.org/devices/"},"https://wiki.lineageos.org/devices/")))}p.isMDXComponent=!0}}]);